<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="shortcut icon" href="assets/img/logo.svg" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil | IntelVision</title>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&icon_names=close,dehaze,edit,logout,mail,password,person,visibility,visibility_off" />
    <link rel="stylesheet" href="css/nav.css">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/profile.css">
</head>

<body onload="loadInfosEmpresa(); retornaTodosOsUsuariosDaEmpresa(); verificarSeUsuarioEstaLogado(); paraLogin()">
    <nav>
        <ul class="first_links">
            <li>
                <a href="servicos.html">Serviços</a>
            </li>
            <li>
                <a href="contato.html">Contato</a>
            </li>
            <li>
                <a href="sobre-nos.html">Sobre nós</a>
            </li>
        </ul>
        <div class="logo">
            <h1>
                <a href="index.html">IntelVision</a>
            </h1>
        </div>
        <ul class="buttons_account">
            <li>
                <a href="login.html" class="login_button">Entrar</a>
            </li>
            <li>
                <a href="cadastro.html" class="register_button">Cadastro</a>
            </li>
        </ul>
        <div class="hamburguer_menu">
            <span class="material-symbols-outlined">
                dehaze
            </span>
        </div>
    </nav>
    <div class="users_container">
        <div class="my_profile">
            <div class="profile_info">
                <div class="profile_image">
                    <img src="assets/profile/default_avatar.webp">
                    <div class="edit">
                        <span class="material-symbols-outlined">
                            edit
                        </span>
                    </div>
                </div>
                <div class="name_logout">
                    <div class="text_infos">
                        <h2 id="nome_usuario"></h2>
                    </div>
                    <div class="logout" id="logout">
                        <span class="material-symbols-outlined">
                            logout
                        </span>
                    </div>
                </div>
                <div class="alter_infos">
                    <div class="name">
                        <div>
                            <span class="material-symbols-outlined">
                                person
                            </span>
                            <p id="nome_empresa_edit"></p>
                        </div>
                        <span class="material-symbols-outlined" id="edit_name">
                            edit
                        </span>
                    </div>
                    <div class="email">
                        <div>
                            <span class="material-symbols-outlined">
                                mail
                            </span>
                            <p id="email_empresa_edit"></p>
                        </div>
                        <span class="material-symbols-outlined" id="edit_email">
                            edit
                        </span>
                    </div>
                    <div class="password">
                        <div>
                            <span class="material-symbols-outlined">
                                password
                            </span>
                            <p>**************</p>
                        </div>
                        <span class="material-symbols-outlined" id="edit_password">
                            edit
                        </span>
                    </div>
                </div>
                <div class="delete_account">
                    <button id="delete_account">
                        Excluir conta
                    </button>
                </div>
            </div>
        </div>
        <div class="all_users">
            <h2>Outros usuários da empresa</h2>
            <div class="users" id="users_container"></div>
        </div>
    </div>
    <div class="out_delete_account out_edit" id="out_delete_account"></div>
    <div class="delete_account_modal modal_edit" id="delete_account_modal">
        <div class="delete_account_headers edit_headers">
            <h3>Excluir conta</h3>
            <span class="material-symbols-outlined" id="close_delete_account_button">
                close
            </span>
        </div>
        <div class="delete_account_content edit_content">
            <p>Você tem certeza que deseja excluir a sua conta?</p>
            <div class="delete_account_button edit_buttons">
                <button class="cancel_button" id="cancel_button_delete_account">
                    Cancelar
                </button>
                <button class="confirm_button_delete" onclick="removerUsuario()">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
    <div class="out_edit_name out_edit" id="out_edit_name"></div>
    <div class="edit_name_modal modal_edit" id="edit_name_modal">
        <div class="edit_name_headers edit_headers">
            <h3>Editar nome</h3>
            <span class="material-symbols-outlined" id="close_edit_name_button">
                close
            </span>
        </div>
        <div class="edit_name_content edit_content">
            <div class="edit_name_field edit_field">
                <label for="">Novo nome</label>
                <input type="name">
            </div>
            <div class="edit_name_button edit_buttons">
                <button class="cancel_button" id="cancel_button_edit_name">
                    Cancelar
                </button>
                <button class="confirm_button" id="submit_button_edit_name">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
    <div class="out_edit_email out_edit" id="out_edit_email"></div>
    <div class="edit_email_modal modal_edit" id="edit_email_modal">
        <div class="edit_email_headers edit_headers">
            <h3>Editar email</h3>
            <span class="material-symbols-outlined" id="close_edit_email_button">
                close
            </span>
        </div>
        <div class="edit_email_content edit_content">
            <div class="edit_email_field edit_field">
                <label for="">Novo email</label>
                <input type="email">
            </div>
            <div class="edit_email_button edit_buttons">
                <button class="cancel_button" id="cancel_button_edit">
                    Cancelar
                </button>
                <button class="confirm_button" id="submit_button_edit_email">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
    <div class="out_edit_password out_edit" id="out_edit_password"></div>
    <div class="edit_password_modal modal_edit" id="edit_password_modal">
        <div class="edit_password_headers edit_headers">
            <h3>Editar Senha</h3>
            <span class="material-symbols-outlined" id="close_edit_password_button">
                close
            </span>
        </div>
        <div class="edit_password_content edit_content">
            <div class="edit_password_field edit_field">
                <label for="">Senha atual</label>
                <input type="password" id="current_password">
                <span class="material-symbols-outlined password_icon" id="view_password_current">
                    visibility
                </span>
            </div>
            <div class="edit_password_field edit_field">
                <label for="">Nova senha</label>
                <input type="password" id="new_password">
                <span class="material-symbols-outlined password_icon" id="view_password_new">
                    visibility
                </span>
            </div>
            <div class="edit_password_button edit_buttons">
                <button class="cancel_button" id="cancel_button_edit_password">
                    Cancelar
                </button>
                <button class="confirm_button" id="submit_button_edit_password">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
</body>
<script src="js/edit_email.js"></script>
<script src="js/edit_password.js"></script>
<script src="js/edit_name.js"></script>
<script src="js/delete_account.js"></script>
<script src="js/perfil_usuario.js"></script>
<script>
    function removerUsuario() {
        fetch('/usuarios/removerUsuario', {
            method: 'DELETE',
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                "id": sessionStorage.getItem('id'),
            }),
        }).then(response => {
            if (response.status == 200) {
                sessionStorage.clear();
                window.location.href = "login.html";
            } else {
                alert("Erro!")
            }
        })
    }
</script>
<script src="js/verifyLogin.js"></script>
<script src="js/logout.js"></script>
</html>